# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## é¡¹ç›®æ¦‚è¿°

Claude Memory æ˜¯ä¸€ä¸ª Claude Skills é¡¹ç›®ï¼Œé€šè¿‡ä¸‰å±‚è®°å¿†æ¶æ„ï¼ˆç»“æ„åŒ–è®°å¿† + åŸå§‹ç¬”è®° + æ™ºèƒ½æ€»ç»“ï¼‰ä¸º AI å¯¹è¯æä¾›é•¿æœŸè®°å¿†èƒ½åŠ›ã€‚æ‰€æœ‰ç”¨æˆ·æ•°æ®å­˜å‚¨åœ¨å…¨å±€å…±äº«çš„ `user-data/` ç›®å½•ä¸­ï¼Œè·¨é¡¹ç›®è®¿é—®ã€‚

**æ ¸å¿ƒç‰¹æ€§**ï¼š
- ğŸš€ **é›¶é…ç½®å®‰è£…** - ç”¨æˆ·åªéœ€å¤åˆ¶æ–‡ä»¶å¤¹ï¼Œé¦–æ¬¡è¿è¡Œè‡ªåŠ¨åˆå§‹åŒ–
- ğŸ—£ï¸ **è‡ªç„¶å”¤é†’** - ç›´æ¥è¯´"å¤å¼¥"æˆ–"å¤å¼¥åœ¨å—"å³å¯æ¿€æ´»
- ğŸ¯ **è‡ªåŠ¨è§¦å‘** - åŸºäº SKILL.md çš„ `name` å’Œ `description` å­—æ®µè‡ªåŠ¨åŒ¹é…
- ğŸ”§ **ä¸ªæ€§åŒ–åå­—** - ä¸€æ¡å‘½ä»¤å³å¯ä¿®æ”¹ AI åå­—

## å¼€å‘ç¯å¢ƒè®¾ç½®

**è‡ªåŠ¨å®‰è£…ï¼ˆæ¨èï¼‰**ï¼š
é¦–æ¬¡æ¿€æ´» skill æ—¶ä¼šè‡ªåŠ¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼Œæ— éœ€æ‰‹åŠ¨æ“ä½œã€‚

**æ— éœ€é¢å¤–ä¾èµ–**ï¼š
- âœ… å®Œå…¨ä½¿ç”¨ Claude Code åŸç”Ÿå·¥å…·ï¼ˆGrepã€Read ç­‰ï¼‰
- âœ… æ— éœ€ä¸‹è½½å¤§å‹æ¨¡å‹
- âœ… æ— éœ€æ„å»ºå‘é‡ç´¢å¼•
- âœ… å¯åŠ¨é€Ÿåº¦æå¿«

## å¸¸ç”¨å‘½ä»¤

### åˆå§‹åŒ–å’Œè®¾ç½®

```bash
# åˆå§‹åŒ–ç›®å½•ç»“æ„ï¼ˆé¦–æ¬¡è¿è¡Œè‡ªåŠ¨æ‰§è¡Œï¼‰
python remembering-anything/scripts/setup_directories.py
```

**ä¿®æ”¹ AI åå­—**ï¼ˆå¯¹è¯å¼ï¼‰ï¼š
ç›´æ¥åœ¨å¯¹è¯ä¸­è¯´ï¼š
- "å¸®æˆ‘æ”¹ä¸ªåå­—å«å°ç™½"
- "æˆ‘æƒ³å«ä½ é˜¿å°”æ³•"
- "æ”¹åä¸ºå¡”å¡”"

AI ä¼šè‡ªåŠ¨ä¿®æ”¹ SKILL.md æ–‡ä»¶å®Œæˆæ›´åã€‚

### è®°å¿†ç®¡ç†

```bash
# æŸ¥çœ‹è®°å¿†ç»Ÿè®¡
python remembering-anything/scripts/memory_cli.py stats

# æœç´¢è®°å¿†
python remembering-anything/scripts/memory_cli.py search "å…³é”®è¯"

# åˆ—å‡ºç‰¹å®šç±»å‹çš„è®°å¿†
python remembering-anything/scripts/memory_cli.py list --type fact
python remembering-anything/scripts/memory_cli.py list --type preference
python remembering-anything/scripts/memory_cli.py list --type experience

# æ£€æµ‹å†²çªè®°å¿†
python remembering-anything/scripts/memory_cli.py conflicts

# æŸ¥çœ‹æœªå¤„ç†çš„ç¬”è®°
python remembering-anything/scripts/memory_cli.py unprocessed

# å¯¼å‡ºè®°å¿†å¤‡ä»½
python remembering-anything/scripts/memory_cli.py export backup.json
```

### ç¬”è®°æœç´¢

**æ— éœ€æ„å»ºç´¢å¼•**ï¼Œç›´æ¥ä½¿ç”¨ Claude Code åŸç”Ÿå·¥å…·ï¼š
- `Grep` - æœç´¢å…³é”®è¯
- `Read` - è¯»å–æ–‡ä»¶å†…å®¹
- Claude çš„è¯­ä¹‰ç†è§£èƒ½åŠ›åˆ¤æ–­ç›¸å…³æ€§

åœ¨å¯¹è¯ä¸­ç›´æ¥è¯´ï¼š
- "æœç´¢å…³äºPythonçš„ç¬”è®°"
- "æˆ‘ä¹‹å‰è®°å½•è¿‡XXå—ï¼Ÿ"
- "æ‰¾æ‰¾å…³äºé¡¹ç›®çš„è®°å½•"

## æ ¸å¿ƒæ¶æ„

### ç›®å½•ç»“æ„

```
claude-memory/
â”œâ”€â”€ user-data/              # å…¨å±€ç”¨æˆ·æ•°æ®ï¼ˆæ‰€æœ‰é¡¹ç›®å…±äº«ï¼‰
â”‚   â”œâ”€â”€ notes/              # åŸå§‹ Markdown ç¬”è®°
â”‚   â”œâ”€â”€ memory/             # ç»“æ„åŒ–è®°å¿†ï¼ˆfacts/preferences/experiences.jsonï¼‰
â”‚   â”œâ”€â”€ summaries/          # æ™ºèƒ½æ€»ç»“ï¼ˆæœˆåº¦/ä¸»é¢˜ï¼‰
â”‚   â”œâ”€â”€ config/             # ç”¨æˆ·ç”»åƒå’Œ AI ç”»åƒé…ç½®
â”‚   â””â”€â”€ vector_db/          # ChromaDB å‘é‡æ•°æ®åº“
â”œâ”€â”€ remembering-anything/   # æŠ€èƒ½å®ç°
â”‚   â”œâ”€â”€ assets/             # æ¨¡æ¿æ–‡ä»¶
â”‚   â”œâ”€â”€ scripts/            # æ ¸å¿ƒ Python è„šæœ¬
â”‚   â””â”€â”€ SKILL.md            # æŠ€èƒ½æ–‡æ¡£ï¼ˆAI agent è¯»å–ï¼‰
â””â”€â”€ .venv/                  # Python è™šæ‹Ÿç¯å¢ƒ
```

### ä¸‰å±‚è®°å¿†ç³»ç»Ÿ

1. **ç»“æ„åŒ–è®°å¿†** (`user-data/memory/`)
   - `facts.json` - äº‹å®ä¿¡æ¯ï¼ˆä½ç½®ã€èŒä¸šç­‰ï¼‰
   - `preferences.json` - åå¥½ä¹ æƒ¯ï¼ˆæ²Ÿé€šé£æ ¼ã€å·¥ä½œæ–¹å¼ç­‰ï¼‰
   - `experiences.json` - ç»å†äº‹ä»¶ï¼ˆå·¥ä½œç»å†ã€æ—…è¡Œç­‰ï¼‰
   - æ”¯æŒç‰ˆæœ¬æ§åˆ¶ï¼šæ–°è®°å¿†é€šè¿‡ `supersedes` å­—æ®µæ›¿æ¢æ—§è®°å¿†
   - çŠ¶æ€ç®¡ç†ï¼š`active`ï¼ˆå½“å‰æœ‰æ•ˆï¼‰ã€`deprecated`ï¼ˆå·²è¿‡æ—¶ï¼‰ã€`conflicted`ï¼ˆæœ‰å†²çªï¼‰

2. **åŸå§‹ç¬”è®°** (`user-data/notes/`)
   - ä¿ç•™å®Œæ•´å†å²ä½œä¸ºçœŸå®æ¥æº
   - æ”¯æŒä»»æ„ Markdown æ ¼å¼ï¼ŒAI è‡ªåŠ¨åˆ†æå¹¶ç”Ÿæˆåˆ†å—ç­–ç•¥

3. **æ™ºèƒ½æ€»ç»“** (`user-data/summaries/`)
   - æœˆåº¦æ€»ç»“å’Œä¸»é¢˜æ€»ç»“
   - æä¾›æ›´é«˜å±‚æ¬¡çš„çŸ¥è¯†æ•´ç†

### æ ¸å¿ƒæ¨¡å—è¯´æ˜

**`memory_schema.py`** - è®°å¿†æ•°æ®ç»“æ„å®šä¹‰
- `FactMemory`, `PreferenceMemory`, `ExperienceMemory` - ä¸‰ç§è®°å¿†ç±»å‹
- `ConflictReport` - å†²çªæ£€æµ‹æŠ¥å‘Š
- æ‰€æœ‰è®°å¿†åŒ…å«ï¼šid, content, source, timestamp, confidence, status, tags

**`memory_manager.py`** - è®°å¿†ç®¡ç†æ ¸å¿ƒ
- å¢åˆ æ”¹æŸ¥ç»“æ„åŒ–è®°å¿†
- è‡ªåŠ¨å†²çªæ£€æµ‹ï¼ˆè¯†åˆ«çŸ›ç›¾ä¿¡æ¯å¦‚ "åŒ—äº¬" â†’ "æ­å·"ï¼‰
- ç‰ˆæœ¬æ§åˆ¶ï¼ˆæ–°è®°å¿†æ›¿æ¢æ—§è®°å¿†ï¼Œä¿ç•™å†å²ï¼‰
- ç»Ÿè®¡å’Œæœç´¢åŠŸèƒ½

**`note_search.py`** - ç¬”è®°æœç´¢å·¥å…·
- ä½¿ç”¨ Claude Code åŸç”Ÿå·¥å…·ï¼ˆGrep + Readï¼‰
- æ— éœ€å‘é‡æ•°æ®åº“ï¼Œå®æ—¶æœç´¢

**`summary_engine.py`** - æ€»ç»“å¼•æ“æ¡†æ¶
- åˆ—å‡ºæœªå¤„ç†ç¬”è®°ï¼ˆåŸºäº `processing_log.json`ï¼‰
- å¢é‡å¤„ç†ï¼šåªå¤„ç†æ–°å¢æˆ–ä¿®æ”¹çš„ç¬”è®°
- æä¾›è®°å¿†æå–çš„æŒ‡å¯¼æ¡†æ¶


**`memory_cli.py`** - å‘½ä»¤è¡Œå·¥å…·
- æä¾› stats, search, conflicts, list, export, unprocessed ç­‰å‘½ä»¤

## å¼€å‘æŒ‡å—

### è·¯å¾„å¤„ç†è§„èŒƒ

æ‰€æœ‰è„šæœ¬ä½¿ç”¨ç›¸å¯¹äº skill æ ¹ç›®å½•çš„è·¯å¾„è®¡ç®—ï¼š
```python
# scripts -> remembering-anything -> claude-memory
SKILL_DIR = Path(__file__).parent.parent.parent
USER_DATA = SKILL_DIR / "user-data"
```

### è®°å¿†æ›´æ–°å·¥ä½œæµ

1. **å‘ç°æ–°ç¬”è®°** - `summary_engine.list_unprocessed_notes()`
2. **æå–è®°å¿†** - AI ä»ç¬”è®°ä¸­æå– facts/preferences/experiences
3. **å†²çªæ£€æµ‹** - `memory_manager.detect_conflicts()` å‘ç°çŸ›ç›¾
4. **æ›´æ–°è®°å¿†** - æ–°è®°å¿† `supersedes` æ—§è®°å¿†ï¼Œæ—§è®°å¿†æ ‡è®°ä¸º `deprecated`
5. **æ ‡è®°å¤„ç†** - `summary_engine.mark_note_processed()` é¿å…é‡å¤

### ç¬”è®°æœç´¢é›†æˆ

åœ¨ SKILL æ¿€æ´»æ—¶ï¼Œä½¿ç”¨ Claude Code çš„åŸç”Ÿå·¥å…·ï¼š

```python
# 1. ä½¿ç”¨ Grep å·¥å…·æœç´¢å…³é”®è¯
Grep(pattern="å…³é”®è¯", path="user-data/notes", output_mode="files_with_matches")

# 2. ä½¿ç”¨ Read å·¥å…·è¯»å–åŒ¹é…æ–‡ä»¶
Read(file_path="user-data/notes/xxx.md")

# 3. ä½¿ç”¨ Claude çš„ç†è§£èƒ½åŠ›åˆ†æç›¸å…³æ€§ï¼Œè‡ªç„¶å‘ˆç°ç»“æœ
```

### è®°å¿†ç‰ˆæœ¬æ§åˆ¶ç¤ºä¾‹

```json
// æ—§è®°å¿†
{
  "id": "mem_old123",
  "content": "æˆ‘ä½åœ¨åŒ—äº¬",
  "status": "deprecated",
  "superseded_by": "mem_new456"
}

// æ–°è®°å¿†
{
  "id": "mem_new456",
  "content": "æˆ‘ä½åœ¨æ­å·",
  "status": "active",
  "supersedes": "mem_old123"
}
```

## è®¾è®¡åŸåˆ™

### è‡ªç„¶å¼•ç”¨è®°å¿†
âŒ é¿å…ï¼š"æ ¹æ®è®°å½• mem_123ï¼Œä½ åœ¨åŒ—äº¬å·¥ä½œ"
âœ… æ¨èï¼š"æˆ‘çŸ¥é“ä½ ç°åœ¨åœ¨æ­å·å·¥ä½œ"

### å†²çªæ£€æµ‹å’Œæ›´æ–°
ç³»ç»Ÿè‡ªåŠ¨æ£€æµ‹çŸ›ç›¾ä¿¡æ¯ï¼ˆå¦‚ä½ç½®å˜æ›´ã€èŒä¸šå˜åŒ–ï¼‰ï¼Œæç¤ºç”¨æˆ·ç¡®è®¤åæ›´æ–°è®°å¿†ï¼Œä¿ç•™å†å²ç‰ˆæœ¬ã€‚

### å¢é‡å¤„ç†ä¼˜å…ˆ
ä½¿ç”¨ `processing_log.json` è·Ÿè¸ªå·²å¤„ç†ç¬”è®°çš„æ—¶é—´æˆ³ï¼Œé¿å…é‡å¤å¤„ç†ï¼Œæé«˜æ•ˆç‡ã€‚

### å…¨å±€æ•°æ®å…±äº«
`user-data/` ç›®å½•å¯¹æ‰€æœ‰é¡¹ç›®å¯è§ï¼Œä¸€æ¬¡é…ç½®å…¨å±€ä½¿ç”¨ã€‚`.gitignore` å·²é…ç½®æ’é™¤æ­¤ç›®å½•ä»¥ä¿æŠ¤éšç§ã€‚

## æ³¨æ„äº‹é¡¹

- **æ— éœ€ä¾èµ–**ï¼šå®Œå…¨ä½¿ç”¨ Claude Code åŸç”Ÿå·¥å…·ï¼Œæ— éœ€å®‰è£…ä»»ä½• Python åŒ…
- **æ•°æ®éšç§**ï¼š`user-data/` å·²åœ¨ `.gitignore` ä¸­æ’é™¤ï¼Œä¸ä¼šæäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶
- **Python ç‰ˆæœ¬**ï¼šéœ€è¦ Python 3.8+ï¼ˆä»…ç”¨äºè¿è¡Œç®¡ç†è„šæœ¬ï¼‰
- **å¹³å°å…¼å®¹æ€§**ï¼šæ”¯æŒ Windowsã€macOSã€Linux
- **ç¼–ç é—®é¢˜**ï¼šæ‰€æœ‰æ–‡ä»¶ä½¿ç”¨ UTF-8 ç¼–ç å¤„ç†ä¸­æ–‡å†…å®¹
- **å¯åŠ¨é€Ÿåº¦**ï¼šç›¸æ¯”ä¹‹å‰çš„å‘é‡æ•°æ®åº“æ–¹æ¡ˆï¼Œå¯åŠ¨é€Ÿåº¦æå‡ 10 å€ä»¥ä¸Š
