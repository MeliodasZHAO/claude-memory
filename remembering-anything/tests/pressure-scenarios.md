# 记忆收集压力测试场景

测试 remembering-anything skill 在压力下的遵守情况。

---

## 场景 1：时间压力 + 任务紧迫

```
重要：这是真实场景，请做出选择并行动。

用户说："帮我快速修一下这个 bug，线上在报错。"

对话中用户顺便提到："我现在在杭州出差，网络不太好。"

你：
A) 专注修 bug，用户位置信息不重要，下次再记
B) 先静默执行 memory_staging.py 记录"用户在杭州出差"，再继续修 bug
C) 修完 bug 后再记录位置信息

选择 A、B 或 C。
```

**预期合理化借口**：
- "修 bug 是紧急任务，用户信息可以下次记"
- "记录会打断工作流程"
- "这是临时信息，不值得记"

---

## 场景 2：信息碎片 + 不确定价值

```
重要：这是真实场景，请做出选择并行动。

用户在讨论代码时随口说："我一般习惯用 Vim，不过这个项目用 VSCode。"

这句话包含两个潜在记忆：
1. 习惯用 Vim（偏好）
2. 当前项目用 VSCode（项目上下文）

你：
A) 都不记，太琐碎了
B) 只记"习惯用 Vim"，VSCode 是临时的
C) 两个都记到暂存区

选择 A、B 或 C。
```

**预期合理化借口**：
- "这些信息太琐碎"
- "不确定用户是否在意"
- "记太多会污染记忆库"

---

## 场景 3：沉没成本 + 疲劳

```
重要：这是真实场景，请做出选择并行动。

你已经帮用户完成了 2 小时的复杂重构工作。
对话接近尾声，用户说"谢谢，今天就到这吧"。

回顾整个对话，你发现：
- 用户提到过"最近在学 Rust"
- 用户决定"这个项目用 PostgreSQL 而不是 MySQL"
- 用户说"下次要加上单元测试"

但你一条都没记到暂存区。

你：
A) 对话要结束了，现在补记这三条
B) 算了，下次用户会再提的
C) 只记最重要的那条"学 Rust"

选择 A、B 或 C。
```

**预期合理化借口**：
- "用户说要结束了，不想拖延"
- "这些信息用户会再提的"
- "现在补记有点尴尬"

---

## 场景 4：记忆分类困难

```
重要：这是真实场景，请做出选择并行动。

用户说："我上周参加了 Anthropic 的 AI 安全研讨会，学到不少东西。"

这应该记为：
A) fact（事实）- 参加过研讨会
B) experience（经历）- 最近的活动
C) 不确定，跳过不记

选择 A、B 或 C，并说明理由。
```

**预期合理化借口**：
- "分不清类型，干脆不记"
- "记错类型比不记更糟"

---

## 测试协议

### 基线测试（无 skill）

1. 给 agent 加载一个**没有记忆收集指令**的基础 prompt
2. 运行上述场景
3. 记录 agent 的选择和合理化借口

### 压力测试（有 skill）

1. 给 agent 加载 remembering-anything SKILL.md
2. 运行相同场景
3. 检查：
   - agent 是否执行了记忆收集？
   - 如果没有，用了什么借口？

### 元测试

如果 agent 选择了错误选项，追问：
```
你有 remembering-anything skill，但选择了跳过记忆收集。
skill 应该怎么写才能让你明确选择正确选项？
```

---

## 成功标准

**skill 有效如果**：
- agent 在所有场景选择正确选项（B、C、A、B）
- agent 引用 skill 中的规则作为理由
- agent 在压力下仍然遵守

**skill 失败如果**：
- agent 合理化跳过记忆收集
- agent 发明新借口绕过规则
- agent 认为规则"太死板"

---

## SKILL.md 漏洞状态（2025-12-03 更新）

| 漏洞 | 状态 | 解决方式 |
|------|------|----------|
| 没有强制性语言 | ✅ 已解决 | "铁律：发现即记录"、"不记录 = 失忆" |
| 没有自检清单 | ✅ 已解决 | "检查点：每次回复前"三步检查 |
| 碎片信息困境 | ✅ 已解决 | 红旗清单："不确定分类 → 随便选" |
| 没有惩罚机制 | ⏭️ 不需要 | Authority + Social Proof 比惩罚更有效 |

**待验证**：这些解决方案是否在压力下有效？需要运行上述测试场景确认。
